---
layout: docs
title: Latency
permalink: latency/
---


<div class="fs-main-and-sidebar">
    <main>
<div id="primary">
<div id="content" role="main">
<article id="post-2720" class="post-2720 page type-page status-publish hentry">
	<header class="entry-header">
		<h1 class="entry-title">Latency</h1>
	</header><!-- .entry-header -->
	<div class="entry-content">
		<p>This page is about latency (input lag) in FS-UAE, and how to reduce it. With latency, we mean slightly different things which are related:</p>
<ol>
<li>An extra delay &#8211; more than would occur on a real Amiga &#8211; before an input event (key press, joystick movement, etc) has an effect in the Amiga.</li>
<li>An extra delay before the Amiga video frame is visible on the computer monitor.</li>
</ol>
<p>The input lag you experience when using FS-UAE will be the sum of these two latencies. In addition, there will be some audio latency as well (not discussed yet).</p>
<h2>Latency Caused by Video Sync</h2>
<p>By default, FS-UAE only updates the screen during the monitors vblank interval. This prevents tearing from occuring, but will also mean that some frames are delayed. A simple way to reduce video latency is to use the option <strong>video_sync = off</strong>.</p>
<p>With default settings, if your current screen mode refresh rate equals the Amiga refresh rate (50Hz for PAL), FS-UAE will also sync the emulation to this display rate to achieve &#8220;perfectly smooth scrolling&#8221;. In order to get good performance by default, FS-UAE emulates one video frame during a 20 ms interval while it renders the last generated video frame in parallel. This &#8220;pipelining&#8221; works well, but introduces one frame of latency (20ms). If you have a decent computer, you may want to enable the following option: <strong>low_latency_vsync = 1</strong>. With this option set, FS-UAE will emulate a frame <strong>and</strong> then render it during the same 20 ms interval. <em>It is possible that future FS-UAE versions will enable low_latency_vsync automatically if it measures that your system can handle it.</em></p>
<p>On a side note, the FS-UAE author looks forward to trying out monitors with G-Sync in the near feature, as that looks promising for both low latency, good performance and smooth scrolling without any obvious drawbacks ðŸ™‚</p>
<p>There are some additional things you should be aware of which can affect video latency:</p>
<h2>Video Frame Queuing</h2>
<p>It is possible that some video drivers queue up frames instead of displaying the immediately, without telling FS-UAE about this. Set the &#8220;max frames to render ahead&#8221; (NVidia) or &#8220;flip queue size&#8221; (AMD/ATI) to 0 (zero) in your video card driver&#8217;s setting utility or control panel. This tip comes from the <a href="http://mednafen.sourceforge.net/documentation/09x/mednafen.html#Advanced+Usage%01Minimizing+video%2Faudio%2Finput+Lag%01Settings+to+Minimize+Video+Lag">mednafen docs</a>, and it is not certain that these driver options are relevant for OpenGL or whether they only apply to Direct3D.</p>
<h2>Game Mode on TVs</h2>
<p>Your monitor can also add some latency to the video output. This is especially true for TVs which processes the video frame heavily before displaying it. If your monitor/TV has a &#8220;game mode&#8221; (very common for TVs), then you should definitively ensure that this is enabled.</p>
<h2>Desktop Compositing</h2>
<p>With desktop environments performing compositing for &#8220;fancy window effects&#8221;, you risk that this compositing introduces an extra frame of latency. Using fullscreen mode usually/probably prevents this from happening &#8211; or just disable the desktop compositing mode if possible. The FS-UAE author uses the MATE desktop on Linux without any compositing to get the best possible OpenGL performance in both windowed and fullscreen mode.</p>
<p>Running FS-UAE in a window with the Unity desktop and nVidia binary drivers causes bad performance when syncing to vblank. This is not a bug in FS-UAE. Use video_sync = off or run in fullscreen instead to work around it.</p>
<h2>Input Latency</h2>
<p>Currently, input is polled from the system devices once every frame (once per 20 ms when emulating a PAL Amiga). This means that some input events which could otherwise be applied to the emulation immediately may have to wait until the next emulated frame.</p>
<p>There are technical reasons why input is only polled once every frame (basically because both the video renderer as well as the input event loop runs in the main thread).</p>
<p>The plan is to move the video renderer to a new/separate thread, so input events can be waited for continuously, and applied at the earliest possible time. This work will be done while migrating FS-UAE from SDL 1.2 to SDL 2.0, as the new version of SDL is better suited to running the video renderer in a separate thread.</p>
<h2>USB Device Latency</h2>
<p>Some USB devices may have higher latency than others. It might be a good idea to not use the cheapest USB game pad available (though price and performance does not always correspond&#8230;).</p>
<p>As an example, it <a href="http://eab.abime.net/showthread.php?t=70528">has been reported</a> that at least some models of the Speed-Link Competition Pro exhibits severe latency.</p>
<h1>Joystick Devices vs Keyboard</h1>
<p>On some systems, joystick/gamepads input may take a more direct route to FS-UAE, while keyboard events are sent via the windowing system. It is possible that this introduces a bit extra latency for keyboard events on some systems. This is not verified, but using a low-latency gamepad / joystick could be a good idea nevertheless.</p>
<h2>Mouse Devices</h2>
<p>TODO: write about the &#8220;new mouse devices&#8221; in the 2.3.x series.</p>
<h2>Audio Latency</h2>
<p>TODO: write about audio latency.</p>
			</div><!-- .entry-content -->
	<footer class="entry-meta">
			</footer><!-- .entry-meta -->
</article><!-- #post-2720 -->
</div><!-- #content -->
</div><!-- #primary -->
    </main>
</div>

